<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<bpel:process xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable" 
xmlns:tns="http://orchestrator.org/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="orchestrator" 
suppressJoinFailure="yes" targetNamespace="http://orchestrator.org/" xmlns:ns="http://ws.external.org/">

	<!-- Import the client WSDL -->
    <bpel:import namespace="http://ws.external.org/" location="external_ws.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import importType="http://schemas.xmlsoap.org/wsdl/" location="orchestratorArtifacts.wsdl" namespace="http://orchestrator.org/"/>

	<bpel:partnerLinks>
		<bpel:partnerLink myRole="orchestratorProvider" name="client" partnerLinkType="tns:orchestrator"/>
		
        
        <bpel:partnerLink name="ExternalWs" partnerLinkType="tns:ExternalWsPartnerLink" partnerRole="externalWsRole"></bpel:partnerLink>
    </bpel:partnerLinks>

	<bpel:variables>
		<bpel:variable messageType="tns:action1Request" name="clientRequest"/>

        <bpel:variable name="ExternalWsResponse" messageType="ns:bcResponse"></bpel:variable>
        <bpel:variable name="ExternalWsRequest" messageType="ns:bc"></bpel:variable>
        <bpel:variable name="ExternalWsResponse1" messageType="ns:bfResponse"></bpel:variable>
        <bpel:variable name="ExternalWsRequest1" messageType="ns:bf"></bpel:variable>
        <bpel:variable name="ExternalWsResponse2" messageType="ns:cfResponse"></bpel:variable>
        <bpel:variable name="ExternalWsRequest2" messageType="ns:cf"></bpel:variable>
        <bpel:variable name="ExternalWsResponse3" messageType="ns:expFResponse"></bpel:variable>
        <bpel:variable name="ExternalWsRequest3" messageType="ns:expF"></bpel:variable>
        <bpel:variable name="ExternalWsResponse4" messageType="ns:cheapFResponse"></bpel:variable>
        <bpel:variable name="ExternalWsRequest4" messageType="ns:cheapF"></bpel:variable>
        <bpel:variable name="conditionif" type="xsd:string">
            <bpel:from>
                <bpel:literal xml:space="preserve">0</bpel:literal>
            </bpel:from>
        </bpel:variable>
        <bpel:variable name="ExternalWsResponse5" messageType="ns:blResponse"></bpel:variable>
        <bpel:variable name="ExternalWsRequest5" messageType="ns:bl"></bpel:variable>
        <bpel:variable name="default" type="xsd:string">
            <bpel:from>
                <bpel:literal xml:space="preserve">None</bpel:literal>
            </bpel:from>
        </bpel:variable>
    </bpel:variables>    <bpel:correlationSets>
		<bpel:correlationSet name="Session" properties="tns:sessionid"/>
	</bpel:correlationSets>

    <bpel:sequence name="main">

        
        <bpel:pick name="PickModel" createInstance="yes"><bpel:onMessage partnerLink="client" operation="action1" portType="tns:orchestrator" variable="clientRequest">
                <bpel:sequence name="onlyCar">
                    
                    <bpel:assign validate="no" name="AssignBCInput">
                        
                    
            
            
            
            
            
            
        
                        
                        
                        <bpel:copy>
                            <bpel:from><bpel:literal><tns:bc xmlns:tns="http://ws.external.org/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <arg0>arg0</arg0>
</tns:bc>
</bpel:literal></bpel:from>
                            <bpel:to variable="ExternalWsRequest" part="parameters"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from variable="default"></bpel:from>
                            <bpel:to part="parameters" variable="ExternalWsRequest">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[arg0]]></bpel:query>
                            </bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                    <bpel:invoke name="bc" partnerLink="ExternalWs" operation="bc" portType="ns:ExternalWs" inputVariable="ExternalWsRequest" outputVariable="ExternalWsResponse"></bpel:invoke>
                    <bpel:reply name="Rd" partnerLink="client" operation="action1" portType="tns:orchestrator" variable="clientRequest"></bpel:reply>
                </bpel:sequence>
            </bpel:onMessage>
            <bpel:onMessage partnerLink="client" operation="action2" portType="tns:orchestrator" variable="clientRequest">
                <bpel:sequence name="CarAndFlight">
                    
                    <bpel:sequence name="getFlight">
                        
                        <bpel:assign validate="no" name="AssigeInput">
                            

                        
                            
                            
                            
                            
                            <bpel:copy>
                                <bpel:from><bpel:literal><tns:cheapF xmlns:tns="http://ws.external.org/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <arg0>arg0</arg0>
</tns:cheapF>
</bpel:literal></bpel:from>
                                <bpel:to variable="ExternalWsRequest4" part="parameters"></bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from><bpel:literal><tns:expF xmlns:tns="http://ws.external.org/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <arg0>arg0</arg0>
</tns:expF>
</bpel:literal></bpel:from>
                                <bpel:to variable="ExternalWsRequest3" part="parameters"></bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from><bpel:literal><tns:cf xmlns:tns="http://ws.external.org/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <arg0>arg0</arg0>
</tns:cf>
</bpel:literal></bpel:from>
                                <bpel:to variable="ExternalWsRequest2" part="parameters"></bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from><bpel:literal><tns:bf xmlns:tns="http://ws.external.org/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <arg0>arg0</arg0>
</tns:bf>
</bpel:literal></bpel:from>
                                <bpel:to variable="ExternalWsRequest1" part="parameters"></bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from variable="default"></bpel:from>
                                <bpel:to part="parameters" variable="ExternalWsRequest1">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[arg0]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from variable="default"></bpel:from>
                                <bpel:to part="parameters" variable="ExternalWsRequest2">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[arg0]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from variable="default"></bpel:from>
                                <bpel:to part="parameters" variable="ExternalWsRequest3">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[arg0]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from variable="default"></bpel:from>
                                <bpel:to part="parameters" variable="ExternalWsRequest4">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[arg0]]></bpel:query>
                                </bpel:to>
                            </bpel:copy>
                        </bpel:assign>
                        <bpel:invoke name="bf" partnerLink="ExternalWs" operation="bf" portType="ns:ExternalWs" inputVariable="ExternalWsRequest1" outputVariable="ExternalWsResponse1"></bpel:invoke>
                        <bpel:invoke name="cf" partnerLink="ExternalWs" operation="cf" portType="ns:ExternalWs" inputVariable="ExternalWsRequest2" outputVariable="ExternalWsResponse2"></bpel:invoke>
                        <bpel:if name="If_expensive">
                        
                        <bpel:condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$conditionif = 0]]></bpel:condition>
                        
                        <bpel:sequence name="expensive">
                                
                                <bpel:invoke name="expF" partnerLink="ExternalWs" operation="expF" portType="ns:ExternalWs" inputVariable="ExternalWsRequest3" outputVariable="ExternalWsResponse3"></bpel:invoke>
                            </bpel:sequence>
                        <bpel:elseif>
		                	<bpel:condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$conditionif =1]]></bpel:condition>
		                	<bpel:sequence name="cheap">
                                    
                                    <bpel:invoke name="cheapF" partnerLink="ExternalWs" operation="cheapF" portType="ns:ExternalWs" inputVariable="ExternalWsRequest4" outputVariable="ExternalWsResponse4"></bpel:invoke>
                                </bpel:sequence>
                        </bpel:elseif>
                        
                        
                        </bpel:if>
                        
                    </bpel:sequence>
                    
                    <bpel:flow name="getCar"><bpel:sequence name="book_car">
                            
                            <bpel:assign validate="no" name="AssignBCInput">
                                <bpel:copy>
                                    <bpel:from><bpel:literal><tns:bc xmlns:tns="http://ws.external.org/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <arg0>arg0</arg0>
</tns:bc>
</bpel:literal></bpel:from>
                                    <bpel:to variable="ExternalWsRequest" part="parameters"></bpel:to>
                                </bpel:copy>
                                <bpel:copy>
                                    <bpel:from variable="default">
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="ExternalWsRequest">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[arg0]]></bpel:query>
                                    </bpel:to>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:invoke name="bc" partnerLink="ExternalWs" operation="bc" portType="ns:ExternalWs" inputVariable="ExternalWsRequest" outputVariable="ExternalWsResponse"></bpel:invoke>
                        </bpel:sequence><bpel:sequence name="book_limo">
                            <bpel:assign validate="no" name="AssignBLInput">
                                <bpel:copy>
                                    <bpel:from><bpel:literal><tns:bl xmlns:tns="http://ws.external.org/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <arg0>arg0</arg0>
</tns:bl>
</bpel:literal></bpel:from>
                                    <bpel:to variable="ExternalWsRequest5" part="parameters"></bpel:to>
                                </bpel:copy>
                                <bpel:copy>
                                    <bpel:from variable="default">
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="ExternalWsRequest5">
                                        <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[arg0]]></bpel:query>
                                    </bpel:to>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:invoke name="bl" partnerLink="ExternalWs" operation="bl" portType="ns:ExternalWs" inputVariable="ExternalWsRequest5" outputVariable="ExternalWsResponse5"></bpel:invoke>
                        </bpel:sequence></bpel:flow>
                    
                    
                    
                    
                    <bpel:reply name="Rd" partnerLink="client" operation="action2" portType="tns:orchestrator" variable="clientRequest"></bpel:reply>
                </bpel:sequence>
            </bpel:onMessage>
        
        </bpel:pick>
        
    </bpel:sequence>
</bpel:process>
